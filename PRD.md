# 프로젝트 현장 관리 솔루션 기획 문서

## 개요
- 본사 프로젝트 관리자가 다수 현장의 공정 단계를 웹 기반으로 관리하며, 승인·반려·변경 이력을 체계적으로 기록·추적하는 솔루션

## 기능 명세

### 회원가입
- 입력정보
  - 사용자 이름
  - 이메일
  - 전화번호
  - 패스워드
- Supabase Auth를 통해서 이메일 인증

### 로그인
- 입력정보
  - 사용자 이메일
  - 패스워드
- Supabase Auth를 통해서  인증된 이메일만 로그인 가능
- 역할이 어드민인 사용자한테 승인되어야지 로그인 가능

### 비밀번호 재설정
- 비밀번호 재설정
- Supabase Auth를 통해서 이메일로 재설정 화면 링크를 보내서 비밀번호 재설정
- 가입되지 않은 이메일로 재설정 링크 보내기 버튼 클릭시 경고 팝업

### 홈 화면
- 글로벌 로그 피드
  - 완전 실시간은 아니어도 됨, 홈 화면 들어올 때마다 새로고침되도록
  - 예시:
    ```
    2025/08/11 11:55 프로젝트A에 담당자 OOO이 “사양변경” 내용을 업데이트하였습니다.
    ```
- NAS 서버(http://192.168.2.63)로 리디렉션 버튼 삽입
- 승인 대기 목록 화면 (알림 리스트)

### 프로젝트 관리 화면
- **목록**
  - 리스트 요소
    - 썸네일
      - 썸네일 없을시 회색화면에 글자로 "썸네일 없음 표시"
    - 현장명
    - 현장담당자
    - 즐겨 찾기 여부
  - 필터·검색
  - 즐겨찾기

- **상세**
  - 이미지 갤러리 (최대 10장, 첨부파일 최대 20MB)
  - 즐겨찾기
  - 영업담당자(필수값)
  - 현장담당자(필수값)
  - 현장명(필수값)
  - 제품명·수량(필수값)
  - 외주업체명(필수값)
  - 발주일(필수값)
  - 준공 예정일(필수값)
  - 설치 요청일(필수값)
  - 공정 상태 값: 계약 → 도면설계 → 발주 → 레이저 → 용접 → 도금 → 도장 → 판넬 → 조립→ 출하 → 설치 → 인증기간 → 마감 → 준공일
    - 위 공정단계마다 진행중, 완료, 대기(착수 전), 지연 상태값 설정 가능
      - 지연 상태값 선택시 사유 입력 가능
    - 각 상태들을 select로 선택하는게 아닌 리스트로 뿌려지고 각 상태마다 공정 단계별 시작일, 마감일 설정이 가능함
    - 현재는 어떤 상태인지 선택해야함(필수 값)

- **히스토리 로그**
  - 프로젝트별 로그 관리
  - 작성자·날짜·내용·첨부파일 포함
  - 카테고리 선택 후 내용 기입
    - 카테고리: 사양변경 / 도면설계 / 구매발주 / 생산제작 / 상하차 / 현장설치시공 / 설치인증
  - 수정 불가, 누적 기록 형태 (단, 관리자 권한 계정으로 삭제 가능)
  - 로그 생성 트리거
    - 직접 히스토리 로그 생성 가능
      - 작성한 사람만있음
    - 사용자 지정 후 승인 요청 할때/받을때
      - 작성한 사람 받는 사람 있음

- **승인/반려**
  - 사용자 지정 후 승인 요청 기능
    - 사용자 지정 + 메모 입력 후 승인 요청
    - 지정된 사용자에게 카카오톡·이메일 알림
    - 알림 클릭 시 홈 화면 승인 대기 목록으로 이동
  - 지정 사용자 → 승인/반려 가능
    - 반려 시 사유 기록
  - 승인/반려 기록은 프로젝트 히스토리 로그에 자동 저장
    - 승인 요청 로그 예시:
      ```
      담당자A “메모 내용” → 담당자B에게 확인 요청 (2025/08/11 11:55)
      ```
    - 승인/반려 로그 예시:
      ```
      담당자B “메모 내용” 확인 완료 (2025/08/11 11:55)
      ```

- **이미지 업로드 관리**
  - 프로젝트별 최대 10장 업로드
  - 썸네일 1~5장 표시 (프로젝트 목록에서 이미지 슬라이드를 통해 확인 가능)
  - 클릭 시 전체 보기
  - 이미지 삭제 기능

- **생성/수정 기능**
  - 상세 페이지 기반 생성/수정 가능
  - 마지막 저장 시간 표시

### 간트차트 & 캘린더 뷰
- 좌측: 프로젝트 정보
- 우측: 간트차트 (공정별 색상)
- 공정 단계(계약 → 도면설계 → 발주 → 레이저 → 용접 → 도금 → 도장 → 판넬 → 조립→ 출하 → 설치 → 인증기간 → 마감 → 준공일)에 따라 간트차트 표시
- 뷰 전환: 간트차트 :양방향_화살표: 캘린더

- **월간 캘린더 뷰**: 전체 현장 일정 확인
  - 클릭 시 해당 일자에 일정이 잡혀 있는 프로젝트 리스트 노출
  - 신규/급한 현장 강조 표시 (간트·캘린더 동일)

### 즐겨찾기
- 프로젝트 즐겨찾기 기능
- 즐겨찾기 프로젝트 전용 페이지 제공

### 계정·권한
- **역할**
  - 관리자
  - 일반 사용자
- **관리자 권한**
  - 사용자별 변경 이력 기록
    - 관리자만 봐야함
    - 각 사용자별로 관련 히스토리 로그를 봐야함
  - 로그 삭제 가능
    - 관리자만 가능
  - **가입**
    - 이메일 가입 → 관리자 승인 후 활성화
    - 전화번호 필수 입력 (카카오톡 알림 발송용)

### 로딩 상태 표시
- **전역 로딩 표시**
  - 페이지 전환 시 로딩 스피너 또는 프로그레스 바 표시
  - 로그인/로그아웃 프로세스 중 로딩 표시
  - 데이터 페칭 중 스켈레톤 UI 또는 로딩 컴포넌트 표시
  
- **로딩 표시가 필요한 주요 동작**
  - 로그인 처리: "로그인 중..." 메시지와 함께 스피너 표시
  - 페이지 이동: 페이지 전환 시 상단 프로그레스 바 또는 전체 화면 로딩
  - 데이터 로드: 테이블, 리스트 등 데이터 로드 시 스켈레톤 UI
  - 파일 업로드: 업로드 진행률 표시
  - 승인/반려 요청: 처리 중 로딩 표시
  - 저장/수정/삭제: 작업 진행 중 버튼 비활성화 및 로딩 표시
  
- **사용자 경험 개선**
  - 모든 비동기 작업에 대한 시각적 피드백 제공
  - 작업 완료 후 성공/실패 메시지 표시
  - 긴 작업의 경우 진행률 퍼센티지 표시
  - 네트워크 오류 시 재시도 옵션 제공

### 주간 로그 리포트
- **자동 엑셀 생성 및 발송**
  - 매주 정해진 시간에 자동 실행 (예: 매주 월요일 오전 9시)
  - 지난 일주일간의 모든 프로젝트 로그를 엑셀 파일로 정리
  - 포함 내용:
    - 프로젝트명, 현장명, 담당자
    - 로그 카테고리별 분류 (사양변경, 도면설계, 구매발주, 생산제작, 상하차, 현장설치시공, 설치인증)
    - 승인/반려 이력
    - 공정 단계 변경 이력
    - 지연 발생 및 사유
  - 지정된 관리자 이메일 주소로 자동 발송
  - 발송 이력 관리 및 재발송 기능

## 기술 스택

### Frontend
- **Next.js 14** - 풀스택 React 프레임워크
  - **App Router** - 서버 컴포넌트 및 라우팅
  - **TypeScript** - 타입 안정성
- **UI 라이브러리**
  - **@fullcalendar/react** - 월간 캘린더 뷰 구현
  - **react-gantt-task** 또는 **dhtmlx-gantt** - 간트차트 구현
  - **react-image-gallery** - 이미지 갤러리 및 썸네일 표시
- **상태 관리**
  - **Zustand** - 전역 상태 관리
- **UI 컴포넌트**
  - **Ant Design** 또는 **Material-UI** - UI 컴포넌트 라이브러리
  - **Tailwind CSS** - 유틸리티 CSS 프레임워크

### Backend & Database
- **Supabase** - Backend as a Service
  - **PostgreSQL** - 관계형 데이터베이스
  - **Row Level Security (RLS)** - 세밀한 데이터 접근 제어
  - **Auth** - 사용자 인증/인가 (이메일 가입, JWT)
  - **Storage** - 이미지 및 첨부파일 저장 (최대 20MB)
  - **Edge Functions** - 서버리스 함수 (알림 발송, 복잡한 비즈니스 로직)
  - **Cron Jobs** - 주간 리포트 자동 발송 스케줄링
- **외부 서비스 연동**
  - **Solapi (솔라피)** - 카카오톡 알림 발송 (Edge Functions 통해 호출)
  - **Resend** - 이메일 발송 (Edge Functions 통해 호출)
  - **ExcelJS** - 엑셀 파일 생성 (주간 로그 리포트)

### Infrastructure
- **Vercel** - Frontend 배포
  - **자동 빌드/배포** - Git 연동
  - **Edge Runtime** - 빠른 응답 속도
  - **Analytics** - 성능 모니터링
- **Supabase Cloud** - Backend 인프라
  - **자동 백업** - 데이터 안정성
  - **확장성** - 트래픽 증가 대응
  - **보안** - SSL, RLS, API 키 관리