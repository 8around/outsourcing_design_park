# 관리자 사용자 관리 페이지

## 개요
관리자가 사용자 승인/거절을 관리할 수 있는 종합적인 관리 페이지입니다.

## 구현된 기능

### 1. 메인 페이지
- **경로**: `/admin/users`
- **파일**: `app/(dashboard)/admin/users/page.tsx`
- **설명**: 서버 컴포넌트로 구성된 메인 페이지

### 2. 핵심 컴포넌트들

#### UsersManagement (메인 컴포넌트)
- **파일**: `components/admin/UsersManagement.tsx`
- **역할**: 전체 사용자 관리 로직과 상태 관리
- **기능**:
  - 사용자 승인/거절 처리
  - 실시간 데이터 갱신
  - 탭별 사용자 목록 관리
  - CSV 내보내기 기능
  - 검색 및 필터링

#### UserStatsCards
- **파일**: `components/admin/UserStatsCards.tsx`
- **역할**: 사용자 통계 표시 카드
- **기능**:
  - 전체, 승인 대기, 승인됨, 거절됨 통계
  - 로딩 상태 표시
  - 색상으로 구분된 상태별 시각화

#### UserTable
- **파일**: `components/admin/UserTable.tsx`
- **역할**: 사용자 목록 테이블
- **기능**:
  - 상태별 컬럼 구성
  - 사용자 상세보기
  - 액션 버튼 (승인/거절/취소)
  - 정렬 및 필터링
  - 페이지네이션

#### UserDetailModal
- **파일**: `components/admin/UserDetailModal.tsx`
- **역할**: 사용자 상세 정보 모달
- **기능**:
  - 사용자 정보 상세 표시
  - 모달 내에서 직접 승인/거절 가능
  - 가입일, 승인일 등 시간 정보 표시

#### UserActions
- **파일**: `components/admin/UserActions.tsx`
- **역할**: 사용자 관리 액션 버튼들
- **기능**:
  - 내보내기 (CSV, Excel, PDF 옵션)
  - 새로고침
  - 일괄 처리 (향후 확장 가능)

### 3. 데이터베이스 타입
- **파일**: `lib/database/types/supabase.ts`
- **내용**: Supabase 데이터베이스 타입 정의
- **테이블**: users, notifications

## 주요 기능

### 탭 구성
1. **승인 대기 (Pending)**: 아직 승인/거절되지 않은 사용자
2. **승인됨 (Approved)**: 승인된 사용자  
3. **거절됨 (Rejected)**: 거절된 사용자

### 사용자 작업
- **승인**: 사용자를 승인하고 시스템 사용 권한 부여
- **거절**: 사용자를 거절하고 선택적 거절 사유 입력
- **승인 취소**: 이미 승인된 사용자의 승인 상태 취소
- **재승인**: 거절된 사용자를 다시 승인

### 검색 및 필터링
- **검색**: 이름, 이메일, 전화번호로 검색
- **정렬**: 가입일 기준 정렬
- **필터**: 상태별 필터링

### 데이터 내보내기
- **CSV 형식**: 현재 보고 있는 탭의 사용자 목록을 CSV로 내보내기
- **파일명**: `users_{상태}_{날짜}.csv` 형식

### 통계 표시
- **전체 사용자 수**
- **승인 대기 사용자 수**
- **승인된 사용자 수**  
- **거절된 사용자 수**

## 기술적 특징

### 상태 관리
- React hooks를 사용한 로컬 상태 관리
- `useAuth` 훅으로 인증된 사용자 정보 접근
- `useCallback`을 사용한 성능 최적화

### UI/UX
- **Ant Design**: 일관된 디자인 시스템
- **반응형 디자인**: 모바일 친화적 레이아웃
- **로딩 상태**: 데이터 로딩 중 스피너 표시
- **확인 다이얼로그**: 중요한 작업 전 확인

### 에러 처리
- **사용자 친화적 에러 메시지**
- **try-catch를 통한 에러 핸들링**
- **토스트 알림**으로 성공/실패 상태 표시

### 접근성
- **키보드 네비게이션 지원**
- **시맨틱 HTML 구조**
- **색상 대비 고려**
- **스크린 리더 지원**

## 보안 고려사항

### 권한 검증
- 관리자 권한이 있는 사용자만 접근 가능
- 미들웨어를 통한 라우트 보호
- 클라이언트와 서버 양쪽에서 권한 확인

### 데이터 보호
- 사용자 개인정보 표시 시 적절한 마스킹
- HTTPS를 통한 안전한 데이터 전송
- SQL 인젝션 방지를 위한 파라미터화된 쿼리

## 성능 최적화

### 컴포넌트 분리
- 기능별 컴포넌트 분리로 재렌더링 최소화
- 메모이제이션을 통한 불필요한 리렌더링 방지

### 데이터 로딩
- 필요한 데이터만 로드
- 페이지네이션으로 대용량 데이터 처리
- 캐싱을 통한 중복 요청 방지

### 코드 분할
- 컴포넌트별 코드 분할
- 지연 로딩으로 초기 번들 크기 최적화

## 확장 가능성

### 향후 추가 가능한 기능
1. **일괄 처리**: 여러 사용자 동시 승인/거절
2. **고급 필터**: 가입일, 부서, 역할별 필터
3. **사용자 활동 로그**: 로그인 기록, 활동 추적
4. **이메일 알림**: 승인/거절 시 자동 이메일 발송
5. **엑셀 내보내기**: 더 풍부한 형식의 데이터 내보내기
6. **사용자 프로필 편집**: 관리자가 사용자 정보 수정
7. **역할 관리**: 사용자 역할 변경 기능

### 성능 개선
1. **가상화**: 대용량 데이터를 위한 가상 스크롤
2. **실시간 업데이트**: WebSocket을 통한 실시간 알림
3. **캐싱**: Redis 캐싱으로 응답 속도 향상
4. **검색 최적화**: Elasticsearch 통합

## 파일 구조
```
app/(dashboard)/admin/users/
├── page.tsx                    # 메인 페이지

components/admin/
├── index.ts                    # 컴포넌트 export 인덱스
├── UsersManagement.tsx         # 메인 관리 컴포넌트
├── UserStatsCards.tsx          # 통계 카드 컴포넌트
├── UserTable.tsx               # 사용자 테이블 컴포넌트
├── UserDetailModal.tsx         # 상세보기 모달
└── UserActions.tsx             # 액션 버튼 컴포넌트

lib/
├── database/types/
│   └── supabase.ts             # 데이터베이스 타입 정의
└── services/
    └── approval.service.ts     # 승인 서비스 (기존)
```

## 사용법

1. **접근**: 관리자 계정으로 로그인 후 `/admin/users` 페이지 방문
2. **사용자 목록**: 각 탭에서 상태별 사용자 목록 확인
3. **사용자 승인**: 승인 대기 탭에서 "승인" 버튼 클릭
4. **사용자 거절**: 승인 대기 탭에서 "거절" 버튼 클릭 후 사유 입력
5. **상세보기**: 사용자 이름 클릭하여 상세 정보 모달 열기
6. **데이터 내보내기**: 우상단 "내보내기" 버튼으로 CSV 다운로드
7. **검색**: 상단 검색창에서 이름, 이메일, 전화번호로 검색

이제 관리자는 직관적이고 효율적인 인터페이스를 통해 사용자 승인 과정을 관리할 수 있습니다.